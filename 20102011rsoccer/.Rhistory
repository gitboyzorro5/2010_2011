for (i_i1_wins_sim in 1:length(i1_teams))
{
i1_home_wins_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$HomeTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "H" & I1_fixtures$i1_gamestatus =="notplayed",])
i1_away_wins_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$AwayTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "A" & I1_fixtures$i1_gamestatus == "notplayed",])
i1_home_draws_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$HomeTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "D" & I1_fixtures$i1_gamestatus == "notplayed",])
i1_away_draws_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$AwayTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "D" & I1_fixtures$i1_gamestatus == "notplayed",])
i1_home_loss_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$HomeTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "A" & I1_fixtures$i1_gamestatus == "notplayed",])
i1_away_loss_sim[i_i1_wins_sim] <- nrow(I1_fixtures[I1_fixtures$AwayTeam_i1 == i1_teams[i_i1_wins_sim] & I1_fixtures$i1_FTR == "H" & I1_fixtures$i1_gamestatus == "notplayed", ])
}
i1_total_wins_sim <- i1_home_wins_sim + i1_away_wins_sim
i1_total_draws_sim <- i1_home_draws_sim + i1_away_draws_sim
i1_total_loss_sim <- i1_home_loss_sim + i1_away_loss_sim
i1_home_games_sim <- c()
i1_away_games_sim <-c()
for (i_i1_sim in 1:length(i1_teams))
{
i1_home_games_sim[i_i1_sim] <- nrow(I1_fixtures[I1_fixtures$HomeTeam_i1 == i1_teams[i_i1_sim] & I1_fixtures$i1_gamestatus == "notplayed",])
i1_away_games_sim[i_i1_sim]  <- nrow(I1_fixtures[I1_fixtures$AwayTeam_i1 == i1_teams[i_i1_sim] & I1_fixtures$i1_gamestatus == "notplayed",])
}
i1_games_played_sim <- i1_home_games_sim + i1_away_games_sim
i1_league_table_sim <- cbind(i1_teams,i1_games_played_sim,i1_total_wins_sim,i1_total_draws_sim,i1_total_loss_sim)
i1_PTS_sim <- (i1_total_wins_sim*3) + (i1_total_draws_sim*1)
i1_league_table_sim <- cbind(i1_league_table_sim,i1_PTS_sim)
i1_games_played_simfinal <- i1_games_played + i1_games_played_sim
i1_total_wins_simfinal <- i1_total_wins + i1_total_wins_sim
i1_total_draws_simfinal <- i1_total_draws + i1_total_draws_sim
i1_total_loss_simfinal <- i1_total_loss + i1_total_loss_sim
i1_PTS_simfinal <- i1_PTS + i1_PTS_sim
i1_league_table_simfinal <- cbind(i1_teams,i1_games_played_simfinal,i1_total_wins_simfinal,i1_total_draws_simfinal,i1_total_loss_simfinal,i1_PTS_simfinal)
i1_league_table_simfinal <- as.data.frame(i1_league_table_simfinal)
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_teams"] <- "Team_f"
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_games_played_simfinal"] <- "P_f"
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_total_wins_simfinal"] <- "W_f"
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_total_draws_simfinal"] <- "D_f"
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_total_loss_simfinal"] <- "L_f"
names(i1_league_table_simfinal)[names(i1_league_table_simfinal) == "i1_PTS_simfinal"] <- "PTS_f"
points_i1_sim <-  i1_league_table_simfinal[order(as.numeric(i1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(i1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "I1_sim",append = TRUE)
write.xlsx(points_i1_sim,'Divisions/Simulations.xlsx', sheetName = "I1_simfinal",append = TRUE)
##################################################################################################################################
##################################################################################################################################
#I2
I2_sim <- I2
I2_sim$matchid <- paste(I2_sim$HomeTeam,I2_sim$AwayTeam,sep = "-")
I2_fixtures$matchid <- paste(I2_fixtures$HomeTeam_i2,I2_fixtures$AwayTeam_i2,sep = "-")
I2_fixtures$i2_FTR <- sapply(I2_fixtures$i2_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
I2_fixtures$i2_gamestatus <- ifelse(I2_fixtures$matchid %in% I2_sim$matchid,"played","notplayed")
i2_home_wins_sim <- c()
i2_away_wins_sim <- c()
i2_home_draws_sim <- c()
i2_away_draws_sim <- c()
i2_home_loss_sim <- c()
i2_away_loss_sim <- c()
for (i_i2_wins_sim in 1:length(i2_teams))
{
i2_home_wins_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$HomeTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "H" & I2_fixtures$i2_gamestatus =="notplayed",])
i2_away_wins_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$AwayTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "A" & I2_fixtures$i2_gamestatus == "notplayed",])
i2_home_draws_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$HomeTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "D" & I2_fixtures$i2_gamestatus == "notplayed",])
i2_away_draws_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$AwayTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "D" & I2_fixtures$i2_gamestatus == "notplayed",])
i2_home_loss_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$HomeTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "A" & I2_fixtures$i2_gamestatus == "notplayed",])
i2_away_loss_sim[i_i2_wins_sim] <- nrow(I2_fixtures[I2_fixtures$AwayTeam_i2 == i2_teams[i_i2_wins_sim] & I2_fixtures$i2_FTR == "H" & I2_fixtures$i2_gamestatus == "notplayed", ])
}
i2_total_wins_sim <- i2_home_wins_sim + i2_away_wins_sim
i2_total_draws_sim <- i2_home_draws_sim + i2_away_draws_sim
i2_total_loss_sim <- i2_home_loss_sim + i2_away_loss_sim
i2_home_games_sim <- c()
i2_away_games_sim <-c()
for (i_i2_sim in 1:length(i2_teams))
{
i2_home_games_sim[i_i2_sim] <- nrow(I2_fixtures[I2_fixtures$HomeTeam_i2 == i2_teams[i_i2_sim] & I2_fixtures$i2_gamestatus == "notplayed",])
i2_away_games_sim[i_i2_sim]  <- nrow(I2_fixtures[I2_fixtures$AwayTeam_i2 == i2_teams[i_i2_sim] & I2_fixtures$i2_gamestatus == "notplayed",])
}
i2_games_played_sim <- i2_home_games_sim + i2_away_games_sim
i2_league_table_sim <- cbind(i2_teams,i2_games_played_sim,i2_total_wins_sim,i2_total_draws_sim,i2_total_loss_sim)
i2_PTS_sim <- (i2_total_wins_sim*3) + (i2_total_draws_sim*1)
i2_league_table_sim <- cbind(i2_league_table_sim,i2_PTS_sim)
i2_games_played_simfinal <- i2_games_played + i2_games_played_sim
i2_total_wins_simfinal <- i2_total_wins + i2_total_wins_sim
i2_total_draws_simfinal <- i2_total_draws + i2_total_draws_sim
i2_total_loss_simfinal <- i2_total_loss + i2_total_loss_sim
i2_PTS_simfinal <- i2_PTS + i2_PTS_sim
i2_league_table_simfinal <- cbind(i2_teams,i2_games_played_simfinal,i2_total_wins_simfinal,i2_total_draws_simfinal,i2_total_loss_simfinal,i2_PTS_simfinal)
i2_league_table_simfinal <- as.data.frame(i2_league_table_simfinal)
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_teams"] <- "Team_f"
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_games_played_simfinal"] <- "P_f"
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_total_wins_simfinal"] <- "W_f"
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_total_draws_simfinal"] <- "D_f"
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_total_loss_simfinal"] <- "L_f"
names(i2_league_table_simfinal)[names(i2_league_table_simfinal) == "i2_PTS_simfinal"] <- "PTS_f"
points_i2_sim <-  i2_league_table_simfinal[order(as.numeric(i2_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(i2_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "I2_sim",append = TRUE)
write.xlsx(points_i2_sim,'Divisions/Simulations.xlsx', sheetName = "I2_simfinal",append = TRUE)
#########################################################################################################################################
#########################################################################################################################################
#N1
N1_sim <- N1
N1_sim$matchid <- paste(N1_sim$HomeTeam,N1_sim$AwayTeam,sep = "-")
N1_fixtures$matchid <- paste(N1_fixtures$HomeTeam_n1,N1_fixtures$AwayTeam_n1,sep = "-")
N1_fixtures$n1_FTR <- sapply(N1_fixtures$n1_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
N1_fixtures$n1_gamestatus <- ifelse(N1_fixtures$matchid %in% N1_sim$matchid,"played","notplayed")
n1_home_wins_sim <- c()
n1_away_wins_sim <- c()
n1_home_draws_sim <- c()
n1_away_draws_sim <- c()
n1_home_loss_sim <- c()
n1_away_loss_sim <- c()
for (i_n1_wins_sim in 1:length(n1_teams))
{
n1_home_wins_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$HomeTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "H" & N1_fixtures$n1_gamestatus =="notplayed",])
n1_away_wins_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$AwayTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "A" & N1_fixtures$n1_gamestatus == "notplayed",])
n1_home_draws_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$HomeTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "D" & N1_fixtures$n1_gamestatus == "notplayed",])
n1_away_draws_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$AwayTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "D" & N1_fixtures$n1_gamestatus == "notplayed",])
n1_home_loss_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$HomeTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "A" & N1_fixtures$n1_gamestatus == "notplayed",])
n1_away_loss_sim[i_n1_wins_sim] <- nrow(N1_fixtures[N1_fixtures$AwayTeam_n1 == n1_teams[i_n1_wins_sim] & N1_fixtures$n1_FTR == "H" & N1_fixtures$n1_gamestatus == "notplayed", ])
}
n1_total_wins_sim <- n1_home_wins_sim + n1_away_wins_sim
n1_total_draws_sim <- n1_home_draws_sim + n1_away_draws_sim
n1_total_loss_sim <- n1_home_loss_sim + n1_away_loss_sim
n1_home_games_sim <- c()
n1_away_games_sim <-c()
for (i_n1_sim in 1:length(n1_teams))
{
n1_home_games_sim[i_n1_sim] <- nrow(N1_fixtures[N1_fixtures$HomeTeam_n1 == n1_teams[i_n1_sim] & N1_fixtures$n1_gamestatus == "notplayed",])
n1_away_games_sim[i_n1_sim]  <- nrow(N1_fixtures[N1_fixtures$AwayTeam_n1 == n1_teams[i_n1_sim] & N1_fixtures$n1_gamestatus == "notplayed",])
}
n1_games_played_sim <- n1_home_games_sim + n1_away_games_sim
n1_league_table_sim <- cbind(n1_teams,n1_games_played_sim,n1_total_wins_sim,n1_total_draws_sim,n1_total_loss_sim)
n1_PTS_sim <- (n1_total_wins_sim*3) + (n1_total_draws_sim*1)
n1_league_table_sim <- cbind(n1_league_table_sim,n1_PTS_sim)
n1_games_played_simfinal <- n1_games_played + n1_games_played_sim
n1_total_wins_simfinal <- n1_total_wins + n1_total_wins_sim
n1_total_draws_simfinal <- n1_total_draws + n1_total_draws_sim
n1_total_loss_simfinal <- n1_total_loss + n1_total_loss_sim
n1_PTS_simfinal <- n1_PTS + n1_PTS_sim
n1_league_table_simfinal <- cbind(n1_teams,n1_games_played_simfinal,n1_total_wins_simfinal,n1_total_draws_simfinal,n1_total_loss_simfinal,n1_PTS_simfinal)
n1_league_table_simfinal <- as.data.frame(n1_league_table_simfinal)
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_teams"] <- "Team_f"
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_games_played_simfinal"] <- "P_f"
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_total_wins_simfinal"] <- "W_f"
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_total_draws_simfinal"] <- "D_f"
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_total_loss_simfinal"] <- "L_f"
names(n1_league_table_simfinal)[names(n1_league_table_simfinal) == "n1_PTS_simfinal"] <- "PTS_f"
points_n1_sim <-  n1_league_table_simfinal[order(as.numeric(n1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(n1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "N1_sim",append = TRUE)
write.xlsx(points_n1_sim,'Divisions/Simulations.xlsx', sheetName = "N1_simfinal",append = TRUE)
###################################################################################################################################
###################################################################################################################################
#P1
P1_sim <- P1
P1_sim$matchid <- paste(P1_sim$HomeTeam,P1_sim$AwayTeam,sep = "-")
P1_fixtures$matchid <- paste(P1_fixtures$HomeTeam_p1,P1_fixtures$AwayTeam_p1,sep = "-")
P1_fixtures$p1_FTR <- sapply(P1_fixtures$p1_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
P1_fixtures$p1_gamestatus <- ifelse(P1_fixtures$matchid %in% P1_sim$matchid,"played","notplayed")
p1_home_wins_sim <- c()
p1_away_wins_sim <- c()
p1_home_draws_sim <- c()
p1_away_draws_sim <- c()
p1_home_loss_sim <- c()
p1_away_loss_sim <- c()
for (i_p1_wins_sim in 1:length(p1_teams))
{
p1_home_wins_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$HomeTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "H" & P1_fixtures$p1_gamestatus =="notplayed",])
p1_away_wins_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$AwayTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "A" & P1_fixtures$p1_gamestatus == "notplayed",])
p1_home_draws_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$HomeTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "D" & P1_fixtures$p1_gamestatus == "notplayed",])
p1_away_draws_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$AwayTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "D" & P1_fixtures$p1_gamestatus == "notplayed",])
p1_home_loss_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$HomeTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "A" & P1_fixtures$p1_gamestatus == "notplayed",])
p1_away_loss_sim[i_p1_wins_sim] <- nrow(P1_fixtures[P1_fixtures$AwayTeam_p1 == p1_teams[i_p1_wins_sim] & P1_fixtures$p1_FTR == "H" & P1_fixtures$p1_gamestatus == "notplayed", ])
}
p1_total_wins_sim <- p1_home_wins_sim + p1_away_wins_sim
p1_total_draws_sim <- p1_home_draws_sim + p1_away_draws_sim
p1_total_loss_sim <- p1_home_loss_sim + p1_away_loss_sim
p1_home_games_sim <- c()
p1_away_games_sim <-c()
for (i_p1_sim in 1:length(p1_teams))
{
p1_home_games_sim[i_p1_sim] <- nrow(P1_fixtures[P1_fixtures$HomeTeam_p1 == p1_teams[i_p1_sim] & P1_fixtures$p1_gamestatus == "notplayed",])
p1_away_games_sim[i_p1_sim]  <- nrow(P1_fixtures[P1_fixtures$AwayTeam_p1 == p1_teams[i_p1_sim] & P1_fixtures$p1_gamestatus == "notplayed",])
}
p1_games_played_sim <- p1_home_games_sim + p1_away_games_sim
p1_league_table_sim <- cbind(p1_teams,p1_games_played_sim,p1_total_wins_sim,p1_total_draws_sim,p1_total_loss_sim)
p1_PTS_sim <- (p1_total_wins_sim*3) + (p1_total_draws_sim*1)
p1_league_table_sim <- cbind(p1_league_table_sim,p1_PTS_sim)
p1_games_played_simfinal <- p1_games_played + p1_games_played_sim
p1_total_wins_simfinal <- p1_total_wins + p1_total_wins_sim
p1_total_draws_simfinal <- p1_total_draws + p1_total_draws_sim
p1_total_loss_simfinal <- p1_total_loss + p1_total_loss_sim
p1_PTS_simfinal <- p1_PTS + p1_PTS_sim
p1_league_table_simfinal <- cbind(p1_teams,p1_games_played_simfinal,p1_total_wins_simfinal,p1_total_draws_simfinal,p1_total_loss_simfinal,p1_PTS_simfinal)
p1_league_table_simfinal <- as.data.frame(p1_league_table_simfinal)
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_teams"] <- "Team_f"
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_games_played_simfinal"] <- "P_f"
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_total_wins_simfinal"] <- "W_f"
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_total_draws_simfinal"] <- "D_f"
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_total_loss_simfinal"] <- "L_f"
names(p1_league_table_simfinal)[names(p1_league_table_simfinal) == "p1_PTS_simfinal"] <- "PTS_f"
points_p1_sim <-  p1_league_table_simfinal[order(as.numeric(p1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(p1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "P1_sim",append = TRUE)
write.xlsx(points_p1_sim,'Divisions/Simulations.xlsx', sheetName = "P1_simfinal",append = TRUE)
##########################################################################################################################################
###################################################################################################################
#SP1
SP1_sim <- SP1
SP1_sim$matchid <- paste(SP1_sim$HomeTeam,SP1_sim$AwayTeam,sep = "-")
SP1_fixtures$matchid <- paste(SP1_fixtures$HomeTeam_sp1,SP1_fixtures$AwayTeam_sp1,sep = "-")
SP1_fixtures$sp1_FTR <- sapply(SP1_fixtures$sp1_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
SP1_fixtures$sp1_gamestatus <- ifelse(SP1_fixtures$matchid %in% SP1_sim$matchid,"played","notplayed")
sp1_home_wins_sim <- c()
sp1_away_wins_sim <- c()
sp1_home_draws_sim <- c()
sp1_away_draws_sim <- c()
sp1_home_loss_sim <- c()
sp1_away_loss_sim <- c()
for (i_sp1_wins_sim in 1:length(sp1_teams))
{
sp1_home_wins_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$HomeTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "H" & SP1_fixtures$sp1_gamestatus =="notplayed",])
sp1_away_wins_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$AwayTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "A" & SP1_fixtures$sp1_gamestatus == "notplayed",])
sp1_home_draws_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$HomeTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "D" & SP1_fixtures$sp1_gamestatus == "notplayed",])
sp1_away_draws_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$AwayTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "D" & SP1_fixtures$sp1_gamestatus == "notplayed",])
sp1_home_loss_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$HomeTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "A" & SP1_fixtures$sp1_gamestatus == "notplayed",])
sp1_away_loss_sim[i_sp1_wins_sim] <- nrow(SP1_fixtures[SP1_fixtures$AwayTeam_sp1 == sp1_teams[i_sp1_wins_sim] & SP1_fixtures$sp1_FTR == "H" & SP1_fixtures$sp1_gamestatus == "notplayed", ])
}
sp1_total_wins_sim <- sp1_home_wins_sim + sp1_away_wins_sim
sp1_total_draws_sim <- sp1_home_draws_sim + sp1_away_draws_sim
sp1_total_loss_sim <- sp1_home_loss_sim + sp1_away_loss_sim
sp1_home_games_sim <- c()
sp1_away_games_sim <-c()
for (i_sp1_sim in 1:length(sp1_teams))
{
sp1_home_games_sim[i_sp1_sim] <- nrow(SP1_fixtures[SP1_fixtures$HomeTeam_sp1 == sp1_teams[i_sp1_sim] & SP1_fixtures$sp1_gamestatus == "notplayed",])
sp1_away_games_sim[i_sp1_sim]  <- nrow(SP1_fixtures[SP1_fixtures$AwayTeam_sp1 == sp1_teams[i_sp1_sim] & SP1_fixtures$sp1_gamestatus == "notplayed",])
}
sp1_games_played_sim <- sp1_home_games_sim + sp1_away_games_sim
sp1_league_table_sim <- cbind(sp1_teams,sp1_games_played_sim,sp1_total_wins_sim,sp1_total_draws_sim,sp1_total_loss_sim)
sp1_PTS_sim <- (sp1_total_wins_sim*3) + (sp1_total_draws_sim*1)
sp1_league_table_sim <- cbind(sp1_league_table_sim,sp1_PTS_sim)
sp1_games_played_simfinal <- sp1_games_played + sp1_games_played_sim
sp1_total_wins_simfinal <- sp1_total_wins + sp1_total_wins_sim
sp1_total_draws_simfinal <- sp1_total_draws + sp1_total_draws_sim
sp1_total_loss_simfinal <- sp1_total_loss + sp1_total_loss_sim
sp1_PTS_simfinal <- sp1_PTS + sp1_PTS_sim
sp1_league_table_simfinal <- cbind(sp1_teams,sp1_games_played_simfinal,sp1_total_wins_simfinal,sp1_total_draws_simfinal,sp1_total_loss_simfinal,sp1_PTS_simfinal)
sp1_league_table_simfinal <- as.data.frame(sp1_league_table_simfinal)
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_teams"] <- "Team_f"
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_games_played_simfinal"] <- "P_f"
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_total_wins_simfinal"] <- "W_f"
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_total_draws_simfinal"] <- "D_f"
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_total_loss_simfinal"] <- "L_f"
names(sp1_league_table_simfinal)[names(sp1_league_table_simfinal) == "sp1_PTS_simfinal"] <- "PTS_f"
points_sp1_sim <-  sp1_league_table_simfinal[order(as.numeric(sp1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(sp1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "SP1_sim",append = TRUE)
write.xlsx(points_sp1_sim,'Divisions/Simulations.xlsx', sheetName = "SP1_simfinal",append = TRUE)
#####################################################################################################################################
###################################################################################################################
#SP2
SP2_sim <- SP2
SP2_sim$matchid <- paste(SP2_sim$HomeTeam,SP2_sim$AwayTeam,sep = "-")
SP2_fixtures$matchid <- paste(SP2_fixtures$HomeTeam_sp2,SP2_fixtures$AwayTeam_sp2,sep = "-")
SP2_fixtures$sp2_FTR <- sapply(SP2_fixtures$sp2_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
SP2_fixtures$sp2_gamestatus <- ifelse(SP2_fixtures$matchid %in% SP2_sim$matchid,"played","notplayed")
sp2_home_wins_sim <- c()
sp2_away_wins_sim <- c()
sp2_home_draws_sim <- c()
sp2_away_draws_sim <- c()
sp2_home_loss_sim <- c()
sp2_away_loss_sim <- c()
for (i_sp2_wins_sim in 1:length(sp2_teams))
{
sp2_home_wins_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$HomeTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "H" & SP2_fixtures$sp2_gamestatus =="notplayed",])
sp2_away_wins_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$AwayTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "A" & SP2_fixtures$sp2_gamestatus == "notplayed",])
sp2_home_draws_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$HomeTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "D" & SP2_fixtures$sp2_gamestatus == "notplayed",])
sp2_away_draws_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$AwayTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "D" & SP2_fixtures$sp2_gamestatus == "notplayed",])
sp2_home_loss_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$HomeTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "A" & SP2_fixtures$sp2_gamestatus == "notplayed",])
sp2_away_loss_sim[i_sp2_wins_sim] <- nrow(SP2_fixtures[SP2_fixtures$AwayTeam_sp2 == sp2_teams[i_sp2_wins_sim] & SP2_fixtures$sp2_FTR == "H" & SP2_fixtures$sp2_gamestatus == "notplayed", ])
}
sp2_total_wins_sim <- sp2_home_wins_sim + sp2_away_wins_sim
sp2_total_draws_sim <- sp2_home_draws_sim + sp2_away_draws_sim
sp2_total_loss_sim <- sp2_home_loss_sim + sp2_away_loss_sim
sp2_home_games_sim <- c()
sp2_away_games_sim <-c()
for (i_sp2_sim in 1:length(sp2_teams))
{
sp2_home_games_sim[i_sp2_sim] <- nrow(SP2_fixtures[SP2_fixtures$HomeTeam_sp2 == sp2_teams[i_sp2_sim] & SP2_fixtures$sp2_gamestatus == "notplayed",])
sp2_away_games_sim[i_sp2_sim]  <- nrow(SP2_fixtures[SP2_fixtures$AwayTeam_sp2 == sp2_teams[i_sp2_sim] & SP2_fixtures$sp2_gamestatus == "notplayed",])
}
sp2_games_played_sim <- sp2_home_games_sim + sp2_away_games_sim
sp2_league_table_sim <- cbind(sp2_teams,sp2_games_played_sim,sp2_total_wins_sim,sp2_total_draws_sim,sp2_total_loss_sim)
sp2_PTS_sim <- (sp2_total_wins_sim*3) + (sp2_total_draws_sim*1)
sp2_league_table_sim <- cbind(sp2_league_table_sim,sp2_PTS_sim)
sp2_games_played_simfinal <- sp2_games_played + sp2_games_played_sim
sp2_total_wins_simfinal <- sp2_total_wins + sp2_total_wins_sim
sp2_total_draws_simfinal <- sp2_total_draws + sp2_total_draws_sim
sp2_total_loss_simfinal <- sp2_total_loss + sp2_total_loss_sim
sp2_PTS_simfinal <- sp2_PTS + sp2_PTS_sim
sp2_league_table_simfinal <- cbind(sp2_teams,sp2_games_played_simfinal,sp2_total_wins_simfinal,sp2_total_draws_simfinal,sp2_total_loss_simfinal,sp2_PTS_simfinal)
sp2_league_table_simfinal <- as.data.frame(sp2_league_table_simfinal)
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_teams"] <- "Team_f"
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_games_played_simfinal"] <- "P_f"
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_total_wins_simfinal"] <- "W_f"
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_total_draws_simfinal"] <- "D_f"
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_total_loss_simfinal"] <- "L_f"
names(sp2_league_table_simfinal)[names(sp2_league_table_simfinal) == "sp2_PTS_simfinal"] <- "PTS_f"
points_sp2_sim <-  sp2_league_table_simfinal[order(as.numeric(sp2_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(sp2_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "SP2_sim",append = TRUE)
write.xlsx(points_sp2_sim,'Divisions/Simulations.xlsx', sheetName = "SP2_simfinal",append = TRUE)
##########################################################################################################################################
##########################################################################################################################################
#SC0
SC0_sim <- SC0
SC0_sim$matchid <- paste(SC0_sim$HomeTeam,SC0_sim$AwayTeam,sep = "-")
SC0_fixtures$matchid <- paste(SC0_fixtures$HomeTeam_sc0,SC0_fixtures$AwayTeam_sc0,sep = "-")
SC0_fixtures$sc0_FTR <- sapply(SC0_fixtures$sc0_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
SC0_fixtures$sc0_gamestatus <- ifelse(SC0_fixtures$matchid %in% SC0_sim$matchid,"played","notplayed")
sc0_home_wins_sim <- c()
sc0_away_wins_sim <- c()
sc0_home_draws_sim <- c()
sc0_away_draws_sim <- c()
sc0_home_loss_sim <- c()
sc0_away_loss_sim <- c()
for (i_sc0_wins_sim in 1:length(sc0_teams))
{
sc0_home_wins_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$HomeTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "H" & SC0_fixtures$sc0_gamestatus =="notplayed",])
sc0_away_wins_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$AwayTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "A" & SC0_fixtures$sc0_gamestatus == "notplayed",])
sc0_home_draws_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$HomeTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "D" & SC0_fixtures$sc0_gamestatus == "notplayed",])
sc0_away_draws_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$AwayTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "D" & SC0_fixtures$sc0_gamestatus == "notplayed",])
sc0_home_loss_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$HomeTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "A" & SC0_fixtures$sc0_gamestatus == "notplayed",])
sc0_away_loss_sim[i_sc0_wins_sim] <- nrow(SC0_fixtures[SC0_fixtures$AwayTeam_sc0 == sc0_teams[i_sc0_wins_sim] & SC0_fixtures$sc0_FTR == "H" & SC0_fixtures$sc0_gamestatus == "notplayed", ])
}
sc0_total_wins_sim <- sc0_home_wins_sim + sc0_away_wins_sim
sc0_total_draws_sim <- sc0_home_draws_sim + sc0_away_draws_sim
sc0_total_loss_sim <- sc0_home_loss_sim + sc0_away_loss_sim
sc0_home_games_sim <- c()
sc0_away_games_sim <-c()
for (i_sc0_sim in 1:length(sc0_teams))
{
sc0_home_games_sim[i_sc0_sim] <- nrow(SC0_fixtures[SC0_fixtures$HomeTeam_sc0 == sc0_teams[i_sc0_sim] & SC0_fixtures$sc0_gamestatus == "notplayed",])
sc0_away_games_sim[i_sc0_sim]  <- nrow(SC0_fixtures[SC0_fixtures$AwayTeam_sc0 == sc0_teams[i_sc0_sim] & SC0_fixtures$sc0_gamestatus == "notplayed",])
}
sc0_games_played_sim <- sc0_home_games_sim + sc0_away_games_sim
sc0_league_table_sim <- cbind(sc0_teams,sc0_games_played_sim,sc0_total_wins_sim,sc0_total_draws_sim,sc0_total_loss_sim)
sc0_PTS_sim <- (sc0_total_wins_sim*3) + (sc0_total_draws_sim*1)
sc0_league_table_sim <- cbind(sc0_league_table_sim,sc0_PTS_sim)
sc0_games_played_simfinal <- sc0_games_played + sc0_games_played_sim
sc0_total_wins_simfinal <- sc0_total_wins + sc0_total_wins_sim
sc0_total_draws_simfinal <- sc0_total_draws + sc0_total_draws_sim
sc0_total_loss_simfinal <- sc0_total_loss + sc0_total_loss_sim
sc0_PTS_simfinal <- sc0_PTS + sc0_PTS_sim
sc0_league_table_simfinal <- cbind(sc0_teams,sc0_games_played_simfinal,sc0_total_wins_simfinal,sc0_total_draws_simfinal,sc0_total_loss_simfinal,sc0_PTS_simfinal)
sc0_league_table_simfinal <- as.data.frame(sc0_league_table_simfinal)
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_teams"] <- "Team_f"
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_games_played_simfinal"] <- "P_f"
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_total_wins_simfinal"] <- "W_f"
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_total_draws_simfinal"] <- "D_f"
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_total_loss_simfinal"] <- "L_f"
names(sc0_league_table_simfinal)[names(sc0_league_table_simfinal) == "sc0_PTS_simfinal"] <- "PTS_f"
points_sc0_sim <-  sc0_league_table_simfinal[order(as.numeric(sc0_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(sc0_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "SC0_sim",append = TRUE)
write.xlsx(points_sc0_sim,'Divisions/Simulations.xlsx', sheetName = "SC0_simfinal",append = TRUE)
######################################################################################################################################
######################################################################################################################################
#SC1
SC1_sim <- SC1
SC1_sim$matchid <- paste(SC1_sim$HomeTeam,SC1_sim$AwayTeam,sep = "-")
SC1_fixtures$matchid <- paste(SC1_fixtures$HomeTeam_sc1,SC1_fixtures$AwayTeam_sc1,sep = "-")
SC1_fixtures$sc1_FTR <- sapply(SC1_fixtures$sc1_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
SC1_fixtures$sc1_gamestatus <- ifelse(SC1_fixtures$matchid %in% SC1_sim$matchid,"played","notplayed")
sc1_home_wins_sim <- c()
sc1_away_wins_sim <- c()
sc1_home_draws_sim <- c()
sc1_away_draws_sim <- c()
sc1_home_loss_sim <- c()
sc1_away_loss_sim <- c()
for (i_sc1_wins_sim in 1:length(sc1_teams))
{
sc1_home_wins_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$HomeTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "H" & SC1_fixtures$sc1_gamestatus =="notplayed",])
sc1_away_wins_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$AwayTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "A" & SC1_fixtures$sc1_gamestatus == "notplayed",])
sc1_home_draws_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$HomeTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "D" & SC1_fixtures$sc1_gamestatus == "notplayed",])
sc1_away_draws_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$AwayTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "D" & SC1_fixtures$sc1_gamestatus == "notplayed",])
sc1_home_loss_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$HomeTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "A" & SC1_fixtures$sc1_gamestatus == "notplayed",])
sc1_away_loss_sim[i_sc1_wins_sim] <- nrow(SC1_fixtures[SC1_fixtures$AwayTeam_sc1 == sc1_teams[i_sc1_wins_sim] & SC1_fixtures$sc1_FTR == "H" & SC1_fixtures$sc1_gamestatus == "notplayed", ])
}
sc1_total_wins_sim <- sc1_home_wins_sim + sc1_away_wins_sim
sc1_total_draws_sim <- sc1_home_draws_sim + sc1_away_draws_sim
sc1_total_loss_sim <- sc1_home_loss_sim + sc1_away_loss_sim
sc1_home_games_sim <- c()
sc1_away_games_sim <-c()
for (i_sc1_sim in 1:length(sc1_teams))
{
sc1_home_games_sim[i_sc1_sim] <- nrow(SC1_fixtures[SC1_fixtures$HomeTeam_sc1 == sc1_teams[i_sc1_sim] & SC1_fixtures$sc1_gamestatus == "notplayed",])
sc1_away_games_sim[i_sc1_sim]  <- nrow(SC1_fixtures[SC1_fixtures$AwayTeam_sc1 == sc1_teams[i_sc1_sim] & SC1_fixtures$sc1_gamestatus == "notplayed",])
}
sc1_games_played_sim <- sc1_home_games_sim + sc1_away_games_sim
sc1_league_table_sim <- cbind(sc1_teams,sc1_games_played_sim,sc1_total_wins_sim,sc1_total_draws_sim,sc1_total_loss_sim)
sc1_PTS_sim <- (sc1_total_wins_sim*3) + (sc1_total_draws_sim*1)
sc1_league_table_sim <- cbind(sc1_league_table_sim,sc1_PTS_sim)
sc1_games_played_simfinal <- sc1_games_played + sc1_games_played_sim
sc1_total_wins_simfinal <- sc1_total_wins + sc1_total_wins_sim
sc1_total_draws_simfinal <- sc1_total_draws + sc1_total_draws_sim
sc1_total_loss_simfinal <- sc1_total_loss + sc1_total_loss_sim
sc1_PTS_simfinal <- sc1_PTS + sc1_PTS_sim
sc1_league_table_simfinal <- cbind(sc1_teams,sc1_games_played_simfinal,sc1_total_wins_simfinal,sc1_total_draws_simfinal,sc1_total_loss_simfinal,sc1_PTS_simfinal)
sc1_league_table_simfinal <- as.data.frame(sc1_league_table_simfinal)
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_teams"] <- "Team_f"
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_games_played_simfinal"] <- "P_f"
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_total_wins_simfinal"] <- "W_f"
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_total_draws_simfinal"] <- "D_f"
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_total_loss_simfinal"] <- "L_f"
names(sc1_league_table_simfinal)[names(sc1_league_table_simfinal) == "sc1_PTS_simfinal"] <- "PTS_f"
points_sc1_sim <-  sc1_league_table_simfinal[order(as.numeric(sc1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(sc1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "SC1_sim",append = TRUE)
write.xlsx(points_sc1_sim,'Divisions/Simulations.xlsx', sheetName = "SC1_simfinal",append = TRUE)
###################################################################################################################################
###################################################################################################################
#T1
T1_sim <- T1
T1_sim$matchid <- paste(T1_sim$HomeTeam,T1_sim$AwayTeam,sep = "-")
T1_fixtures$matchid <- paste(T1_fixtures$HomeTeam_t1,T1_fixtures$AwayTeam_t1,sep = "-")
T1_fixtures$t1_FTR <- sapply(T1_fixtures$t1_pscore,switch,
'1-0' = 'H','2-0'='H','2-1'= 'H','3-0'= 'H','3-1'= 'H','3-2'= 'H','4-0'= 'H','4-1'= 'H','4-2'= 'H','4-3'= 'H','5-0'= 'H','5-1'= 'H','5-2'= 'H','5-3'= 'H','5-4'= 'H','6-0'= 'H','6-1'= 'H','6-2'= 'H','6-3'= 'H','6-4'= 'H','6-5'= 'H','7-0'= 'H','7-2'= 'H','9-0'= 'H',
'0-0' = 'D','1-1' = 'D','2-2' = 'D','3-3' = 'D','4-4' = 'D','5-5' = 'D',
'0-1'= 'A','0-2' = 'A','1-2'= 'A','0-3'= 'A','1-3'= 'A','2-3'= 'A','0-4'= 'A','1-4'= 'A','2-4'= 'A','3-4'= 'A','0-5'= 'A','1-5'= 'A','2-5'= 'A','3-5'= 'A','4-5'= 'A','0-6'= 'A','1-6'= 'A','2-6'= 'A','3-6'= 'A','4-6'= 'A','3-8'= 'A','5-6'= 'A')
T1_fixtures$t1_gamestatus <- ifelse(T1_fixtures$matchid %in% T1_sim$matchid,"played","notplayed")
t1_home_wins_sim <- c()
t1_away_wins_sim <- c()
t1_home_draws_sim <- c()
t1_away_draws_sim <- c()
t1_home_loss_sim <- c()
t1_away_loss_sim <- c()
for (i_t1_wins_sim in 1:length(t1_teams))
{
t1_home_wins_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$HomeTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "H" & T1_fixtures$t1_gamestatus =="notplayed",])
t1_away_wins_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$AwayTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "A" & T1_fixtures$t1_gamestatus == "notplayed",])
t1_home_draws_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$HomeTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "D" & T1_fixtures$t1_gamestatus == "notplayed",])
t1_away_draws_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$AwayTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "D" & T1_fixtures$t1_gamestatus == "notplayed",])
t1_home_loss_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$HomeTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "A" & T1_fixtures$t1_gamestatus == "notplayed",])
t1_away_loss_sim[i_t1_wins_sim] <- nrow(T1_fixtures[T1_fixtures$AwayTeam_t1 == t1_teams[i_t1_wins_sim] & T1_fixtures$t1_FTR == "H" & T1_fixtures$t1_gamestatus == "notplayed", ])
}
t1_total_wins_sim <- t1_home_wins_sim + t1_away_wins_sim
t1_total_draws_sim <- t1_home_draws_sim + t1_away_draws_sim
t1_total_loss_sim <- t1_home_loss_sim + t1_away_loss_sim
t1_home_games_sim <- c()
t1_away_games_sim <-c()
for (i_t1_sim in 1:length(t1_teams))
{
t1_home_games_sim[i_t1_sim] <- nrow(T1_fixtures[T1_fixtures$HomeTeam_t1 == t1_teams[i_t1_sim] & T1_fixtures$t1_gamestatus == "notplayed",])
t1_away_games_sim[i_t1_sim]  <- nrow(T1_fixtures[T1_fixtures$AwayTeam_t1 == t1_teams[i_t1_sim] & T1_fixtures$t1_gamestatus == "notplayed",])
}
t1_games_played_sim <- t1_home_games_sim + t1_away_games_sim
t1_league_table_sim <- cbind(t1_teams,t1_games_played_sim,t1_total_wins_sim,t1_total_draws_sim,t1_total_loss_sim)
t1_PTS_sim <- (t1_total_wins_sim*3) + (t1_total_draws_sim*1)
t1_league_table_sim <- cbind(t1_league_table_sim,t1_PTS_sim)
t1_games_played_simfinal <- t1_games_played + t1_games_played_sim
t1_total_wins_simfinal <- t1_total_wins + t1_total_wins_sim
t1_total_draws_simfinal <- t1_total_draws + t1_total_draws_sim
t1_total_loss_simfinal <- t1_total_loss + t1_total_loss_sim
t1_PTS_simfinal <- t1_PTS + t1_PTS_sim
t1_league_table_simfinal <- cbind(t1_teams,t1_games_played_simfinal,t1_total_wins_simfinal,t1_total_draws_simfinal,t1_total_loss_simfinal,t1_PTS_simfinal)
t1_league_table_simfinal <- as.data.frame(t1_league_table_simfinal)
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_teams"] <- "Team_f"
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_games_played_simfinal"] <- "P_f"
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_total_wins_simfinal"] <- "W_f"
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_total_draws_simfinal"] <- "D_f"
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_total_loss_simfinal"] <- "L_f"
names(t1_league_table_simfinal)[names(t1_league_table_simfinal) == "t1_PTS_simfinal"] <- "PTS_f"
points_t1_sim <-  t1_league_table_simfinal[order(as.numeric(t1_league_table_simfinal$PTS_f), decreasing = TRUE),]
write.xlsx(t1_league_table_sim,'Divisions/Simulations.xlsx', sheetName = "T1_sim",append = TRUE)
write.xlsx(points_t1_sim,'Divisions/Simulations.xlsx', sheetName = "T1_simfinal",append = TRUE)
######################################################################################################################################
B1_rounds
nrow(B1_rounds)
nrow(D1_rounds)
#Master file to run all other scripts
#load the data
source("divisions.R")
source("GoalTotalsV2.R")
source("GSmatrix.R")
source("GCmatrix.R")
source("WinMargin.R")
source("Teamform.R")
source("CSform.R")
source("TGmatrix.R")
source("Totalgoals.R")
source("TeamAgainst.R")
source("ShotsAnalysis.R")
source("LeagueTables.R")
source("PoissonModel.R")
#delete files in divisions
unlink("Divisions/*",recursive = T,force = T)
source("MasterWrite.R")
source("LastSix.R")
source("LeagueFixtures.R")
source("TableSimulation.R")
