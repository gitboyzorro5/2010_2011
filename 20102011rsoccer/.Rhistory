i2_firstgames <- length(i2_teams)/2
I2_firstsplit <-  head(I2_margindata,i2_firstgames)
I2_secondsplit <- tail(I2_margindata,nrow(I2_margindata) - i2_firstgames)
I2_secondsplit$i2_HomeTeam_index_wm <- match(I2_secondsplit$HomeTeam,i2_teams)
I2_secondsplit$i2_AwayTeam_index_wm <- match(I2_secondsplit$AwayTeam,i2_teams)
I2_secondsplit$i2_homegame_no <- rep(2:i2_games_played[1] - 1, each = length(i2_teams)/2)
I2_secondsplit$i2_awaygame_no <- rep(2:i2_games_played[1] - 1, each = length(i2_teams)/2)
i2_homewinmargin <- c()
i2_awaywinmargin <- c()
for (i2_secondsplitrow in 1:nrow(I2_secondsplit))
{
i2_hometeamindex_wm <- I2_secondsplit[i2_secondsplitrow,"i2_HomeTeam_index_wm"]
i2_awayteamindex_wm <- I2_secondsplit[i2_secondsplitrow,"i2_AwayTeam_index_wm"]
i2_hometeam_game_no <- I2_secondsplit[i2_secondsplitrow,"i2_homegame_no"]
i2_awayteam_game_no <- I2_secondsplit[i2_secondsplitrow,"i2_awaygame_no"]
i2_winmargin_vec_gamestate_h <- as.vector(i2_winmargin_h[i2_hometeamindex_wm,])
i2_winmargin_vec_gamestate_h[is.na(i2_winmargin_vec_gamestate_h)] <- ""
i2_winmargin_vec_gamestate_h <- i2_winmargin_vec_gamestate_h[i2_winmargin_vec_gamestate_h != ""]
i2_winmargin_vec_gamestate_h <- as.numeric(i2_winmargin_vec_gamestate_h)
i2_winmargin_vec_gamestate_a <- as.vector(i2_winmargin_h[i2_awayteamindex_wm,])
i2_winmargin_vec_gamestate_a[is.na(i2_winmargin_vec_gamestate_a)] <- ""
i2_winmargin_vec_gamestate_a <- i2_winmargin_vec_gamestate_a[i2_winmargin_vec_gamestate_a != ""]
i2_winmargin_vec_gamestate_a <- as.numeric(i2_winmargin_vec_gamestate_a)
for (i2_game_no in 1:i2_games_played[1])
{
i2_homewinmargin[i2_secondsplitrow] <- i2_winmargin_vec_gamestate_h[i2_hometeam_game_no]
i2_awaywinmargin[i2_secondsplitrow] <- i2_winmargin_vec_gamestate_a[i2_awayteam_game_no]
}
}
i2_homewinmargin
i2_awaywinmargin
I2_gamestate_data <- cbind(I2_secondsplit,i2_homewinmargin,i2_awaywinmargin)
I2_gamestate_data$i2_GSCS <- paste(I2_gamestate_data$i2_homewinmargin,I2_gamestate_data$i2_awaywinmargin, sep = ",")
I2_gamestate_data$i2_GSH <- I2_gamestate_data$i2_homewinmargin - I2_gamestate_data$i2_awaywinmargin
head(I2_gamestate_data,5)
I2_gamestate_copy <- I2_gamestate_data
I2_gamestate_copy$i2_HomeTeam_index_wm <- NULL
I2_gamestate_copy$i2_AwayTeam_index_wm <- NULL
I2_gamestate_copy$i2_homegame_no <- NULL
I2_gamestate_copy$i2_awaygame_no <- NULL
I2_gamestate_copy$X <- NULL
colnames(I2_gamestate_copy)[20] <- "homewinmargin"
colnames(I2_gamestate_copy)[21] <- "awaywinmargin"
colnames(I2_gamestate_copy)[22] <- "GSCS"
colnames(I2_gamestate_copy)[23] <- "GSH"
#end I2
###################################################################################################
#N1
# N1_margindata <- N1
# n1_teams <- sort(unique(N1$HomeTeam))
# n1_firstgames <- length(n1_teams)/2
# N1_firstsplit <-  head(N1_margindata,n1_firstgames)
# N1_secondsplit <- tail(N1_margindata,nrow(N1_margindata) - n1_firstgames)
# N1_secondsplit$n1_HomeTeam_index_wm <- match(N1_secondsplit$HomeTeam,n1_teams)
# N1_secondsplit$n1_AwayTeam_index_wm <- match(N1_secondsplit$AwayTeam,n1_teams)
# N1_secondsplit$n1_homegame_no <- rep(2:n1_games_played[1] - 1, each = length(n1_teams)/2)
# N1_secondsplit$n1_awaygame_no <- rep(2:n1_games_played[1] - 1, each = length(n1_teams)/2)
#
# n1_homewinmargin <- c()
# n1_awaywinmargin <- c()
#
# for (n1_secondsplitrow in 1:nrow(N1_secondsplit))
# {
#
#   n1_hometeamindex_wm <- N1_secondsplit[n1_secondsplitrow,"n1_HomeTeam_index_wm"]
#   n1_awayteamindex_wm <- N1_secondsplit[n1_secondsplitrow,"n1_AwayTeam_index_wm"]
#   n1_hometeam_game_no <- N1_secondsplit[n1_secondsplitrow,"n1_homegame_no"]
#   n1_awayteam_game_no <- N1_secondsplit[n1_secondsplitrow,"n1_awaygame_no"]
#
#   n1_winmargin_vec_gamestate_h <- as.vector(n1_winmargin_h[n1_hometeamindex_wm,])
#   n1_winmargin_vec_gamestate_h[is.na(n1_winmargin_vec_gamestate_h)] <- ""
#   n1_winmargin_vec_gamestate_h <- n1_winmargin_vec_gamestate_h[n1_winmargin_vec_gamestate_h != ""]
#   n1_winmargin_vec_gamestate_h <- as.numeric(n1_winmargin_vec_gamestate_h)
#
#   n1_winmargin_vec_gamestate_a <- as.vector(n1_winmargin_h[n1_awayteamindex_wm,])
#   n1_winmargin_vec_gamestate_a[is.na(n1_winmargin_vec_gamestate_a)] <- ""
#   n1_winmargin_vec_gamestate_a <- n1_winmargin_vec_gamestate_a[n1_winmargin_vec_gamestate_a != ""]
#   n1_winmargin_vec_gamestate_a <- as.numeric(n1_winmargin_vec_gamestate_a)
#
#   for (n1_game_no in 1:n1_games_played[1])
#
#   {
#
#     n1_homewinmargin[n1_secondsplitrow] <- n1_winmargin_vec_gamestate_h[n1_hometeam_game_no]
#     n1_awaywinmargin[n1_secondsplitrow] <- n1_winmargin_vec_gamestate_a[n1_awayteam_game_no]
#
#
#   }
#
# }
#
# n1_homewinmargin
# n1_awaywinmargin
#
# N1_gamestate_data <- cbind(N1_secondsplit,n1_homewinmargin,n1_awaywinmargin)
# N1_gamestate_data$n1_GSCS <- paste(N1_gamestate_data$n1_homewinmargin,N1_gamestate_data$n1_awaywinmargin, sep = ",")
# N1_gamestate_data$n1_GSH <- N1_gamestate_data$n1_homewinmargin - N1_gamestate_data$n1_awaywinmargin
# head(N1_gamestate_data,5)
# N1_gamestate_copy <- N1_gamestate_data
# N1_gamestate_copy$n1_HomeTeam_index_wm <- NULL
# N1_gamestate_copy$n1_AwayTeam_index_wm <- NULL
# N1_gamestate_copy$n1_homegame_no <- NULL
# N1_gamestate_copy$n1_awaygame_no <- NULL
# N1_gamestate_copy$X <- NULL
# colnames(N1_gamestate_copy)[20] <- "homewinmargin"
# colnames(N1_gamestate_copy)[21] <- "awaywinmargin"
# colnames(N1_gamestate_copy)[22] <- "GSCS"
# colnames(N1_gamestate_copy)[23] <- "GSH"
#end N1
###################################################################################################
#P1
P1_margindata <- P1
p1_teams <- sort(unique(P1$HomeTeam))
p1_firstgames <- length(p1_teams)/2
P1_firstsplit <-  head(P1_margindata,p1_firstgames)
P1_secondsplit <- tail(P1_margindata,nrow(P1_margindata) - p1_firstgames)
P1_secondsplit$p1_HomeTeam_index_wm <- match(P1_secondsplit$HomeTeam,p1_teams)
P1_secondsplit$p1_AwayTeam_index_wm <- match(P1_secondsplit$AwayTeam,p1_teams)
P1_secondsplit$p1_homegame_no <- rep(2:p1_games_played[1] - 1, each = length(p1_teams)/2)
P1_secondsplit$p1_awaygame_no <- rep(2:p1_games_played[1] - 1, each = length(p1_teams)/2)
p1_homewinmargin <- c()
p1_awaywinmargin <- c()
for (p1_secondsplitrow in 1:nrow(P1_secondsplit))
{
p1_hometeamindex_wm <- P1_secondsplit[p1_secondsplitrow,"p1_HomeTeam_index_wm"]
p1_awayteamindex_wm <- P1_secondsplit[p1_secondsplitrow,"p1_AwayTeam_index_wm"]
p1_hometeam_game_no <- P1_secondsplit[p1_secondsplitrow,"p1_homegame_no"]
p1_awayteam_game_no <- P1_secondsplit[p1_secondsplitrow,"p1_awaygame_no"]
p1_winmargin_vec_gamestate_h <- as.vector(p1_winmargin_h[p1_hometeamindex_wm,])
p1_winmargin_vec_gamestate_h[is.na(p1_winmargin_vec_gamestate_h)] <- ""
p1_winmargin_vec_gamestate_h <- p1_winmargin_vec_gamestate_h[p1_winmargin_vec_gamestate_h != ""]
p1_winmargin_vec_gamestate_h <- as.numeric(p1_winmargin_vec_gamestate_h)
p1_winmargin_vec_gamestate_a <- as.vector(p1_winmargin_h[p1_awayteamindex_wm,])
p1_winmargin_vec_gamestate_a[is.na(p1_winmargin_vec_gamestate_a)] <- ""
p1_winmargin_vec_gamestate_a <- p1_winmargin_vec_gamestate_a[p1_winmargin_vec_gamestate_a != ""]
p1_winmargin_vec_gamestate_a <- as.numeric(p1_winmargin_vec_gamestate_a)
for (p1_game_no in 1:p1_games_played[1])
{
p1_homewinmargin[p1_secondsplitrow] <- p1_winmargin_vec_gamestate_h[p1_hometeam_game_no]
p1_awaywinmargin[p1_secondsplitrow] <- p1_winmargin_vec_gamestate_a[p1_awayteam_game_no]
}
}
p1_homewinmargin
p1_awaywinmargin
P1_gamestate_data <- cbind(P1_secondsplit,p1_homewinmargin,p1_awaywinmargin)
P1_gamestate_data$p1_GSCS <- paste(P1_gamestate_data$p1_homewinmargin,P1_gamestate_data$p1_awaywinmargin, sep = ",")
P1_gamestate_data$p1_GSH <- P1_gamestate_data$p1_homewinmargin - P1_gamestate_data$p1_awaywinmargin
head(P1_gamestate_data,5)
P1_gamestate_copy <- P1_gamestate_data
P1_gamestate_copy$p1_HomeTeam_index_wm <- NULL
P1_gamestate_copy$p1_AwayTeam_index_wm <- NULL
P1_gamestate_copy$p1_homegame_no <- NULL
P1_gamestate_copy$p1_awaygame_no <- NULL
P1_gamestate_copy$X <- NULL
colnames(P1_gamestate_copy)[20] <- "homewinmargin"
colnames(P1_gamestate_copy)[21] <- "awaywinmargin"
colnames(P1_gamestate_copy)[22] <- "GSCS"
colnames(P1_gamestate_copy)[23] <- "GSH"
#end P1
###################################################################################################
#SC0
SC0_margindata <- SC0
sc0_teams <- sort(unique(SC0$HomeTeam))
sc0_firstgames <- length(sc0_teams)/2
SC0_firstsplit <-  head(SC0_margindata,sc0_firstgames)
SC0_secondsplit <- tail(SC0_margindata,nrow(SC0_margindata) - sc0_firstgames)
SC0_secondsplit$sc0_HomeTeam_index_wm <- match(SC0_secondsplit$HomeTeam,sc0_teams)
SC0_secondsplit$sc0_AwayTeam_index_wm <- match(SC0_secondsplit$AwayTeam,sc0_teams)
SC0_secondsplit$sc0_homegame_no <- rep(2:sc0_games_played[1] - 1, each = length(sc0_teams)/2)
SC0_secondsplit$sc0_awaygame_no <- rep(2:sc0_games_played[1] - 1, each = length(sc0_teams)/2)
sc0_homewinmargin <- c()
sc0_awaywinmargin <- c()
for (sc0_secondsplitrow in 1:nrow(SC0_secondsplit))
{
sc0_hometeamindex_wm <- SC0_secondsplit[sc0_secondsplitrow,"sc0_HomeTeam_index_wm"]
sc0_awayteamindex_wm <- SC0_secondsplit[sc0_secondsplitrow,"sc0_AwayTeam_index_wm"]
sc0_hometeam_game_no <- SC0_secondsplit[sc0_secondsplitrow,"sc0_homegame_no"]
sc0_awayteam_game_no <- SC0_secondsplit[sc0_secondsplitrow,"sc0_awaygame_no"]
sc0_winmargin_vec_gamestate_h <- as.vector(sc0_winmargin_h[sc0_hometeamindex_wm,])
sc0_winmargin_vec_gamestate_h[is.na(sc0_winmargin_vec_gamestate_h)] <- ""
sc0_winmargin_vec_gamestate_h <- sc0_winmargin_vec_gamestate_h[sc0_winmargin_vec_gamestate_h != ""]
sc0_winmargin_vec_gamestate_h <- as.numeric(sc0_winmargin_vec_gamestate_h)
sc0_winmargin_vec_gamestate_a <- as.vector(sc0_winmargin_h[sc0_awayteamindex_wm,])
sc0_winmargin_vec_gamestate_a[is.na(sc0_winmargin_vec_gamestate_a)] <- ""
sc0_winmargin_vec_gamestate_a <- sc0_winmargin_vec_gamestate_a[sc0_winmargin_vec_gamestate_a != ""]
sc0_winmargin_vec_gamestate_a <- as.numeric(sc0_winmargin_vec_gamestate_a)
for (sc0_game_no in 1:sc0_games_played[1])
{
sc0_homewinmargin[sc0_secondsplitrow] <- sc0_winmargin_vec_gamestate_h[sc0_hometeam_game_no]
sc0_awaywinmargin[sc0_secondsplitrow] <- sc0_winmargin_vec_gamestate_a[sc0_awayteam_game_no]
}
}
sc0_homewinmargin
sc0_awaywinmargin
SC0_gamestate_data <- cbind(SC0_secondsplit,sc0_homewinmargin,sc0_awaywinmargin)
SC0_gamestate_data$sc0_GSCS <- paste(SC0_gamestate_data$sc0_homewinmargin,SC0_gamestate_data$sc0_awaywinmargin, sep = ",")
SC0_gamestate_data$sc0_GSH <- SC0_gamestate_data$sc0_homewinmargin - SC0_gamestate_data$sc0_awaywinmargin
head(SC0_gamestate_data,5)
SC0_gamestate_copy <- SC0_gamestate_data
SC0_gamestate_copy$sc0_HomeTeam_index_wm <- NULL
SC0_gamestate_copy$sc0_AwayTeam_index_wm <- NULL
SC0_gamestate_copy$sc0_homegame_no <- NULL
SC0_gamestate_copy$sc0_awaygame_no <- NULL
SC0_gamestate_copy$X <- NULL
colnames(SC0_gamestate_copy)[20] <- "homewinmargin"
colnames(SC0_gamestate_copy)[21] <- "awaywinmargin"
colnames(SC0_gamestate_copy)[22] <- "GSCS"
colnames(SC0_gamestate_copy)[23] <- "GSH"
#end SC0
###################################################################################################
#SC1
SC1_margindata <- SC1
sc1_teams <- sort(unique(SC1$HomeTeam))
sc1_firstgames <- length(sc1_teams)/2
SC1_firstsplit <-  head(SC1_margindata,sc1_firstgames)
SC1_secondsplit <- tail(SC1_margindata,nrow(SC1_margindata) - sc1_firstgames)
SC1_secondsplit$sc1_HomeTeam_index_wm <- match(SC1_secondsplit$HomeTeam,sc1_teams)
SC1_secondsplit$sc1_AwayTeam_index_wm <- match(SC1_secondsplit$AwayTeam,sc1_teams)
SC1_secondsplit$sc1_homegame_no <- rep(2:sc1_games_played[1] - 1, each = length(sc1_teams)/2)
SC1_secondsplit$sc1_awaygame_no <- rep(2:sc1_games_played[1] - 1, each = length(sc1_teams)/2)
sc1_homewinmargin <- c()
sc1_awaywinmargin <- c()
for (sc1_secondsplitrow in 1:nrow(SC1_secondsplit))
{
sc1_hometeamindex_wm <- SC1_secondsplit[sc1_secondsplitrow,"sc1_HomeTeam_index_wm"]
sc1_awayteamindex_wm <- SC1_secondsplit[sc1_secondsplitrow,"sc1_AwayTeam_index_wm"]
sc1_hometeam_game_no <- SC1_secondsplit[sc1_secondsplitrow,"sc1_homegame_no"]
sc1_awayteam_game_no <- SC1_secondsplit[sc1_secondsplitrow,"sc1_awaygame_no"]
sc1_winmargin_vec_gamestate_h <- as.vector(sc1_winmargin_h[sc1_hometeamindex_wm,])
sc1_winmargin_vec_gamestate_h[is.na(sc1_winmargin_vec_gamestate_h)] <- ""
sc1_winmargin_vec_gamestate_h <- sc1_winmargin_vec_gamestate_h[sc1_winmargin_vec_gamestate_h != ""]
sc1_winmargin_vec_gamestate_h <- as.numeric(sc1_winmargin_vec_gamestate_h)
sc1_winmargin_vec_gamestate_a <- as.vector(sc1_winmargin_h[sc1_awayteamindex_wm,])
sc1_winmargin_vec_gamestate_a[is.na(sc1_winmargin_vec_gamestate_a)] <- ""
sc1_winmargin_vec_gamestate_a <- sc1_winmargin_vec_gamestate_a[sc1_winmargin_vec_gamestate_a != ""]
sc1_winmargin_vec_gamestate_a <- as.numeric(sc1_winmargin_vec_gamestate_a)
for (sc1_game_no in 1:sc1_games_played[1])
{
sc1_homewinmargin[sc1_secondsplitrow] <- sc1_winmargin_vec_gamestate_h[sc1_hometeam_game_no]
sc1_awaywinmargin[sc1_secondsplitrow] <- sc1_winmargin_vec_gamestate_a[sc1_awayteam_game_no]
}
}
sc1_homewinmargin
sc1_awaywinmargin
SC1_gamestate_data <- cbind(SC1_secondsplit,sc1_homewinmargin,sc1_awaywinmargin)
SC1_gamestate_data$sc1_GSCS <- paste(SC1_gamestate_data$sc1_homewinmargin,SC1_gamestate_data$sc1_awaywinmargin, sep = ",")
SC1_gamestate_data$sc1_GSH <- SC1_gamestate_data$sc1_homewinmargin - SC1_gamestate_data$sc1_awaywinmargin
head(SC1_gamestate_data,5)
SC1_gamestate_copy <- SC1_gamestate_data
SC1_gamestate_copy$sc1_HomeTeam_index_wm <- NULL
SC1_gamestate_copy$sc1_AwayTeam_index_wm <- NULL
SC1_gamestate_copy$sc1_homegame_no <- NULL
SC1_gamestate_copy$sc1_awaygame_no <- NULL
SC1_gamestate_copy$X <- NULL
colnames(SC1_gamestate_copy)[20] <- "homewinmargin"
colnames(SC1_gamestate_copy)[21] <- "awaywinmargin"
colnames(SC1_gamestate_copy)[22] <- "GSCS"
colnames(SC1_gamestate_copy)[23] <- "GSH"
#end SC1
###################################################################################################
#SC2
SC2_margindata <- SC2
sc2_teams <- sort(unique(SC2$HomeTeam))
sc2_firstgames <- length(sc2_teams)/2
SC2_firstsplit <-  head(SC2_margindata,sc2_firstgames)
SC2_secondsplit <- tail(SC2_margindata,nrow(SC2_margindata) - sc2_firstgames)
SC2_secondsplit$sc2_HomeTeam_index_wm <- match(SC2_secondsplit$HomeTeam,sc2_teams)
SC2_secondsplit$sc2_AwayTeam_index_wm <- match(SC2_secondsplit$AwayTeam,sc2_teams)
SC2_secondsplit$sc2_homegame_no <- rep(2:sc2_games_played[1] - 1, each = length(sc2_teams)/2)
SC2_secondsplit$sc2_awaygame_no <- rep(2:sc2_games_played[1] - 1, each = length(sc2_teams)/2)
sc2_homewinmargin <- c()
sc2_awaywinmargin <- c()
for (sc2_secondsplitrow in 1:nrow(SC2_secondsplit))
{
sc2_hometeamindex_wm <- SC2_secondsplit[sc2_secondsplitrow,"sc2_HomeTeam_index_wm"]
sc2_awayteamindex_wm <- SC2_secondsplit[sc2_secondsplitrow,"sc2_AwayTeam_index_wm"]
sc2_hometeam_game_no <- SC2_secondsplit[sc2_secondsplitrow,"sc2_homegame_no"]
sc2_awayteam_game_no <- SC2_secondsplit[sc2_secondsplitrow,"sc2_awaygame_no"]
sc2_winmargin_vec_gamestate_h <- as.vector(sc2_winmargin_h[sc2_hometeamindex_wm,])
sc2_winmargin_vec_gamestate_h[is.na(sc2_winmargin_vec_gamestate_h)] <- ""
sc2_winmargin_vec_gamestate_h <- sc2_winmargin_vec_gamestate_h[sc2_winmargin_vec_gamestate_h != ""]
sc2_winmargin_vec_gamestate_h <- as.numeric(sc2_winmargin_vec_gamestate_h)
sc2_winmargin_vec_gamestate_a <- as.vector(sc2_winmargin_h[sc2_awayteamindex_wm,])
sc2_winmargin_vec_gamestate_a[is.na(sc2_winmargin_vec_gamestate_a)] <- ""
sc2_winmargin_vec_gamestate_a <- sc2_winmargin_vec_gamestate_a[sc2_winmargin_vec_gamestate_a != ""]
sc2_winmargin_vec_gamestate_a <- as.numeric(sc2_winmargin_vec_gamestate_a)
for (sc2_game_no in 1:sc2_games_played[1])
{
sc2_homewinmargin[sc2_secondsplitrow] <- sc2_winmargin_vec_gamestate_h[sc2_hometeam_game_no]
sc2_awaywinmargin[sc2_secondsplitrow] <- sc2_winmargin_vec_gamestate_a[sc2_awayteam_game_no]
}
}
sc2_homewinmargin
sc2_awaywinmargin
SC2_gamestate_data <- cbind(SC2_secondsplit,sc2_homewinmargin,sc2_awaywinmargin)
SC2_gamestate_data$sc2_GSCS <- paste(SC2_gamestate_data$sc2_homewinmargin,SC2_gamestate_data$sc2_awaywinmargin, sep = ",")
SC2_gamestate_data$sc2_GSH <- SC2_gamestate_data$sc2_homewinmargin - SC2_gamestate_data$sc2_awaywinmargin
head(SC2_gamestate_data,5)
SC2_gamestate_copy <- SC2_gamestate_data
SC2_gamestate_copy$sc2_HomeTeam_index_wm <- NULL
SC2_gamestate_copy$sc2_AwayTeam_index_wm <- NULL
SC2_gamestate_copy$sc2_homegame_no <- NULL
SC2_gamestate_copy$sc2_awaygame_no <- NULL
SC2_gamestate_copy$X <- NULL
colnames(SC2_gamestate_copy)[20] <- "homewinmargin"
colnames(SC2_gamestate_copy)[21] <- "awaywinmargin"
colnames(SC2_gamestate_copy)[22] <- "GSCS"
colnames(SC2_gamestate_copy)[23] <- "GSH"
#end SC2
###################################################################################################
#SC3
SC3_margindata <- SC3
sc3_teams <- sort(unique(SC3$HomeTeam))
sc3_firstgames <- length(sc3_teams)/2
SC3_firstsplit <-  head(SC3_margindata,sc3_firstgames)
SC3_secondsplit <- tail(SC3_margindata,nrow(SC3_margindata) - sc3_firstgames)
SC3_secondsplit$sc3_HomeTeam_index_wm <- match(SC3_secondsplit$HomeTeam,sc3_teams)
SC3_secondsplit$sc3_AwayTeam_index_wm <- match(SC3_secondsplit$AwayTeam,sc3_teams)
SC3_secondsplit$sc3_homegame_no <- rep(2:sc3_games_played[1] - 1, each = length(sc3_teams)/2)
SC3_secondsplit$sc3_awaygame_no <- rep(2:sc3_games_played[1] - 1, each = length(sc3_teams)/2)
sc3_homewinmargin <- c()
sc3_awaywinmargin <- c()
for (sc3_secondsplitrow in 1:nrow(SC3_secondsplit))
{
sc3_hometeamindex_wm <- SC3_secondsplit[sc3_secondsplitrow,"sc3_HomeTeam_index_wm"]
sc3_awayteamindex_wm <- SC3_secondsplit[sc3_secondsplitrow,"sc3_AwayTeam_index_wm"]
sc3_hometeam_game_no <- SC3_secondsplit[sc3_secondsplitrow,"sc3_homegame_no"]
sc3_awayteam_game_no <- SC3_secondsplit[sc3_secondsplitrow,"sc3_awaygame_no"]
sc3_winmargin_vec_gamestate_h <- as.vector(sc3_winmargin_h[sc3_hometeamindex_wm,])
sc3_winmargin_vec_gamestate_h[is.na(sc3_winmargin_vec_gamestate_h)] <- ""
sc3_winmargin_vec_gamestate_h <- sc3_winmargin_vec_gamestate_h[sc3_winmargin_vec_gamestate_h != ""]
sc3_winmargin_vec_gamestate_h <- as.numeric(sc3_winmargin_vec_gamestate_h)
sc3_winmargin_vec_gamestate_a <- as.vector(sc3_winmargin_h[sc3_awayteamindex_wm,])
sc3_winmargin_vec_gamestate_a[is.na(sc3_winmargin_vec_gamestate_a)] <- ""
sc3_winmargin_vec_gamestate_a <- sc3_winmargin_vec_gamestate_a[sc3_winmargin_vec_gamestate_a != ""]
sc3_winmargin_vec_gamestate_a <- as.numeric(sc3_winmargin_vec_gamestate_a)
for (sc3_game_no in 1:sc3_games_played[1])
{
sc3_homewinmargin[sc3_secondsplitrow] <- sc3_winmargin_vec_gamestate_h[sc3_hometeam_game_no]
sc3_awaywinmargin[sc3_secondsplitrow] <- sc3_winmargin_vec_gamestate_a[sc3_awayteam_game_no]
}
}
sc3_homewinmargin
sc3_awaywinmargin
SC3_gamestate_data <- cbind(SC3_secondsplit,sc3_homewinmargin,sc3_awaywinmargin)
SC3_gamestate_data$sc3_GSCS <- paste(SC3_gamestate_data$sc3_homewinmargin,SC3_gamestate_data$sc3_awaywinmargin, sep = ",")
SC3_gamestate_data$sc3_GSH <- SC3_gamestate_data$sc3_homewinmargin - SC3_gamestate_data$sc3_awaywinmargin
head(SC3_gamestate_data,5)
SC3_gamestate_copy <- SC3_gamestate_data
SC3_gamestate_copy$sc3_HomeTeam_index_wm <- NULL
SC3_gamestate_copy$sc3_AwayTeam_index_wm <- NULL
SC3_gamestate_copy$sc3_homegame_no <- NULL
SC3_gamestate_copy$sc3_awaygame_no <- NULL
SC3_gamestate_copy$X <- NULL
colnames(SC3_gamestate_copy)[20] <- "homewinmargin"
colnames(SC3_gamestate_copy)[21] <- "awaywinmargin"
colnames(SC3_gamestate_copy)[22] <- "GSCS"
colnames(SC3_gamestate_copy)[23] <- "GSH"
#end SC3
###################################################################################################
#SP1
SP1_margindata <- SP1
sp1_teams <- sort(unique(SP1$HomeTeam))
sp1_firstgames <- length(sp1_teams)/2
SP1_firstsplit <-  head(SP1_margindata,sp1_firstgames)
SP1_secondsplit <- tail(SP1_margindata,nrow(SP1_margindata) - sp1_firstgames)
SP1_secondsplit$sp1_HomeTeam_index_wm <- match(SP1_secondsplit$HomeTeam,sp1_teams)
SP1_secondsplit$sp1_AwayTeam_index_wm <- match(SP1_secondsplit$AwayTeam,sp1_teams)
SP1_secondsplit$sp1_homegame_no <- rep(2:sp1_games_played[1] - 1, each = length(sp1_teams)/2)
SP1_secondsplit$sp1_awaygame_no <- rep(2:sp1_games_played[1] - 1, each = length(sp1_teams)/2)
sp1_homewinmargin <- c()
sp1_awaywinmargin <- c()
for (sp1_secondsplitrow in 1:nrow(SP1_secondsplit))
{
sp1_hometeamindex_wm <- SP1_secondsplit[sp1_secondsplitrow,"sp1_HomeTeam_index_wm"]
sp1_awayteamindex_wm <- SP1_secondsplit[sp1_secondsplitrow,"sp1_AwayTeam_index_wm"]
sp1_hometeam_game_no <- SP1_secondsplit[sp1_secondsplitrow,"sp1_homegame_no"]
sp1_awayteam_game_no <- SP1_secondsplit[sp1_secondsplitrow,"sp1_awaygame_no"]
sp1_winmargin_vec_gamestate_h <- as.vector(sp1_winmargin_h[sp1_hometeamindex_wm,])
sp1_winmargin_vec_gamestate_h[is.na(sp1_winmargin_vec_gamestate_h)] <- ""
sp1_winmargin_vec_gamestate_h <- sp1_winmargin_vec_gamestate_h[sp1_winmargin_vec_gamestate_h != ""]
sp1_winmargin_vec_gamestate_h <- as.numeric(sp1_winmargin_vec_gamestate_h)
sp1_winmargin_vec_gamestate_a <- as.vector(sp1_winmargin_h[sp1_awayteamindex_wm,])
sp1_winmargin_vec_gamestate_a[is.na(sp1_winmargin_vec_gamestate_a)] <- ""
sp1_winmargin_vec_gamestate_a <- sp1_winmargin_vec_gamestate_a[sp1_winmargin_vec_gamestate_a != ""]
sp1_winmargin_vec_gamestate_a <- as.numeric(sp1_winmargin_vec_gamestate_a)
for (sp1_game_no in 1:sp1_games_played[1])
{
sp1_homewinmargin[sp1_secondsplitrow] <- sp1_winmargin_vec_gamestate_h[sp1_hometeam_game_no]
sp1_awaywinmargin[sp1_secondsplitrow] <- sp1_winmargin_vec_gamestate_a[sp1_awayteam_game_no]
}
}
sp1_homewinmargin
sp1_awaywinmargin
SP1_gamestate_data <- cbind(SP1_secondsplit,sp1_homewinmargin,sp1_awaywinmargin)
SP1_gamestate_data$sp1_GSCS <- paste(SP1_gamestate_data$sp1_homewinmargin,SP1_gamestate_data$sp1_awaywinmargin, sep = ",")
SP1_gamestate_data$sp1_GSH <- SP1_gamestate_data$sp1_homewinmargin - SP1_gamestate_data$sp1_awaywinmargin
head(SP1_gamestate_data,5)
SP1_gamestate_copy <- SP1_gamestate_data
SP1_gamestate_copy$sp1_HomeTeam_index_wm <- NULL
SP1_gamestate_copy$sp1_AwayTeam_index_wm <- NULL
SP1_gamestate_copy$sp1_homegame_no <- NULL
SP1_gamestate_copy$sp1_awaygame_no <- NULL
SP1_gamestate_copy$X <- NULL
colnames(SP1_gamestate_copy)[20] <- "homewinmargin"
colnames(SP1_gamestate_copy)[21] <- "awaywinmargin"
colnames(SP1_gamestate_copy)[22] <- "GSCS"
colnames(SP1_gamestate_copy)[23] <- "GSH"
#end SP1
###################################################################################################
SP2_margindata <- SP2
sp2_teams <- sort(unique(SP2$HomeTeam))
sp2_firstgames <- length(sp2_teams)/2
SP2_firstsplit <-  head(SP2_margindata,sp2_firstgames)
SP2_secondsplit <- tail(SP2_margindata,nrow(SP2_margindata) - sp2_firstgames)
SP2_secondsplit$sp2_HomeTeam_index_wm <- match(SP2_secondsplit$HomeTeam,sp2_teams)
SP2_secondsplit$sp2_AwayTeam_index_wm <- match(SP2_secondsplit$AwayTeam,sp2_teams)
SP2_secondsplit$sp2_homegame_no <- rep(2:sp2_games_played[1] - 1, each = length(sp2_teams)/2)
SP2_secondsplit$sp2_awaygame_no <- rep(2:sp2_games_played[1] - 1, each = length(sp2_teams)/2)
sp2_homewinmargin <- c()
sp2_awaywinmargin <- c()
for (sp2_secondsplitrow in 1:nrow(SP2_secondsplit))
{
sp2_hometeamindex_wm <- SP2_secondsplit[sp2_secondsplitrow,"sp2_HomeTeam_index_wm"]
sp2_awayteamindex_wm <- SP2_secondsplit[sp2_secondsplitrow,"sp2_AwayTeam_index_wm"]
sp2_hometeam_game_no <- SP2_secondsplit[sp2_secondsplitrow,"sp2_homegame_no"]
sp2_awayteam_game_no <- SP2_secondsplit[sp2_secondsplitrow,"sp2_awaygame_no"]
sp2_winmargin_vec_gamestate_h <- as.vector(sp2_winmargin_h[sp2_hometeamindex_wm,])
sp2_winmargin_vec_gamestate_h[is.na(sp2_winmargin_vec_gamestate_h)] <- ""
sp2_winmargin_vec_gamestate_h <- sp2_winmargin_vec_gamestate_h[sp2_winmargin_vec_gamestate_h != ""]
sp2_winmargin_vec_gamestate_h <- as.numeric(sp2_winmargin_vec_gamestate_h)
sp2_winmargin_vec_gamestate_a <- as.vector(sp2_winmargin_h[sp2_awayteamindex_wm,])
sp2_winmargin_vec_gamestate_a[is.na(sp2_winmargin_vec_gamestate_a)] <- ""
sp2_winmargin_vec_gamestate_a <- sp2_winmargin_vec_gamestate_a[sp2_winmargin_vec_gamestate_a != ""]
sp2_winmargin_vec_gamestate_a <- as.numeric(sp2_winmargin_vec_gamestate_a)
for (sp2_game_no in 1:sp2_games_played[1])
{
sp2_homewinmargin[sp2_secondsplitrow] <- sp2_winmargin_vec_gamestate_h[sp2_hometeam_game_no]
sp2_awaywinmargin[sp2_secondsplitrow] <- sp2_winmargin_vec_gamestate_a[sp2_awayteam_game_no]
}
}
sp2_homewinmargin
sp2_awaywinmargin
SP2_gamestate_data <- cbind(SP2_secondsplit,sp2_homewinmargin,sp2_awaywinmargin)
SP2_gamestate_data$sp2_GSCS <- paste(SP2_gamestate_data$sp2_homewinmargin,SP2_gamestate_data$sp2_awaywinmargin, sep = ",")
SP2_gamestate_data$sp2_GSH <- SP2_gamestate_data$sp2_homewinmargin - SP2_gamestate_data$sp2_awaywinmargin
head(SP2_gamestate_data,5)
SP2_gamestate_copy <- SP2_gamestate_data
SP2_gamestate_copy$sp2_HomeTeam_index_wm <- NULL
SP2_gamestate_copy$sp2_AwayTeam_index_wm <- NULL
SP2_gamestate_copy$sp2_homegame_no <- NULL
SP2_gamestate_copy$sp2_awaygame_no <- NULL
SP2_gamestate_copy$X <- NULL
colnames(SP2_gamestate_copy)[20] <- "homewinmargin"
colnames(SP2_gamestate_copy)[21] <- "awaywinmargin"
colnames(SP2_gamestate_copy)[22] <- "GSCS"
colnames(SP2_gamestate_copy)[23] <- "GSH"
#end SP2
###################################################################################################
#T1
T1_margindata <- T1
t1_teams <- sort(unique(T1$HomeTeam))
t1_firstgames <- length(t1_teams)/2
T1_firstsplit <-  head(T1_margindata,t1_firstgames)
T1_secondsplit <- tail(T1_margindata,nrow(T1_margindata) - t1_firstgames)
T1_secondsplit$t1_HomeTeam_index_wm <- match(T1_secondsplit$HomeTeam,t1_teams)
T1_secondsplit$t1_AwayTeam_index_wm <- match(T1_secondsplit$AwayTeam,t1_teams)
T1_secondsplit$t1_homegame_no <- rep(2:t1_games_played[1] - 1, each = length(t1_teams)/2)
T1_secondsplit$t1_awaygame_no <- rep(2:t1_games_played[1] - 1, each = length(t1_teams)/2)
t1_homewinmargin <- c()
t1_awaywinmargin <- c()
for (t1_secondsplitrow in 1:nrow(T1_secondsplit))
{
t1_hometeamindex_wm <- T1_secondsplit[t1_secondsplitrow,"t1_HomeTeam_index_wm"]
t1_awayteamindex_wm <- T1_secondsplit[t1_secondsplitrow,"t1_AwayTeam_index_wm"]
t1_hometeam_game_no <- T1_secondsplit[t1_secondsplitrow,"t1_homegame_no"]
t1_awayteam_game_no <- T1_secondsplit[t1_secondsplitrow,"t1_awaygame_no"]
t1_winmargin_vec_gamestate_h <- as.vector(t1_winmargin_h[t1_hometeamindex_wm,])
t1_winmargin_vec_gamestate_h[is.na(t1_winmargin_vec_gamestate_h)] <- ""
t1_winmargin_vec_gamestate_h <- t1_winmargin_vec_gamestate_h[t1_winmargin_vec_gamestate_h != ""]
t1_winmargin_vec_gamestate_h <- as.numeric(t1_winmargin_vec_gamestate_h)
t1_winmargin_vec_gamestate_a <- as.vector(t1_winmargin_h[t1_awayteamindex_wm,])
t1_winmargin_vec_gamestate_a[is.na(t1_winmargin_vec_gamestate_a)] <- ""
t1_winmargin_vec_gamestate_a <- t1_winmargin_vec_gamestate_a[t1_winmargin_vec_gamestate_a != ""]
t1_winmargin_vec_gamestate_a <- as.numeric(t1_winmargin_vec_gamestate_a)
for (t1_game_no in 1:t1_games_played[1])
{
t1_homewinmargin[t1_secondsplitrow] <- t1_winmargin_vec_gamestate_h[t1_hometeam_game_no]
t1_awaywinmargin[t1_secondsplitrow] <- t1_winmargin_vec_gamestate_a[t1_awayteam_game_no]
}
}
t1_homewinmargin
t1_awaywinmargin
T1_gamestate_data <- cbind(T1_secondsplit,t1_homewinmargin,t1_awaywinmargin)
T1_gamestate_data$t1_GSCS <- paste(T1_gamestate_data$t1_homewinmargin,T1_gamestate_data$t1_awaywinmargin, sep = ",")
T1_gamestate_data$t1_GSH <- T1_gamestate_data$t1_homewinmargin - T1_gamestate_data$t1_awaywinmargin
head(T1_gamestate_data,5)
T1_gamestate_copy <- T1_gamestate_data
T1_gamestate_copy$t1_HomeTeam_index_wm <- NULL
T1_gamestate_copy$t1_AwayTeam_index_wm <- NULL
T1_gamestate_copy$t1_homegame_no <- NULL
T1_gamestate_copy$t1_awaygame_no <- NULL
T1_gamestate_copy$X <- NULL
colnames(T1_gamestate_copy)[20] <- "homewinmargin"
colnames(T1_gamestate_copy)[21] <- "awaywinmargin"
colnames(T1_gamestate_copy)[22] <- "GSCS"
colnames(T1_gamestate_copy)[23] <- "GSH"
allteams202102011_gamestate <- rbind(B1_gamestate_copy,D1_gamestate_copy,D2_gamestate_copy,E0_gamestate_copy,E1_gamestate_copy,E2_gamestate_copy,
E3_gamestate_copy,EC_gamestate_copy,F1_gamestate_copy,F2_gamestate_copy,G1_gamestate_copy,I1_gamestate_copy,I2_gamestate_copy,#N1_gamestate_copy#,
P1_gamestate_copy,SC0_gamestate_copy,SC1_gamestate_copy,SC2_gamestate_copy,SC3_gamestate_copy,SP1_gamestate_copy,SP2_gamestate_copy,T1_gamestate_copy)
nrow(allteams202102011_gamestate)
allteams202102011_gamestate
